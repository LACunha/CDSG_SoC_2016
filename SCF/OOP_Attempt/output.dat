    -----------------------------------------------------------------------
          Psi4: An Open-Source Ab Initio Electronic Structure Package
                              Psi4 1.0rc47 Driver

                          Git: Rev {master} 514daad dirty

    J. M. Turney, A. C. Simmonett, R. M. Parrish, E. G. Hohenstein,
    F. A. Evangelista, J. T. Fermann, B. J. Mintz, L. A. Burns, J. J. Wilke,
    M. L. Abrams, N. J. Russ, M. L. Leininger, C. L. Janssen, E. T. Seidl,
    W. D. Allen, H. F. Schaefer, R. A. King, E. F. Valeev, C. D. Sherrill,
    and T. D. Crawford, WIREs Comput. Mol. Sci. 2, 556-565 (2012)
    (doi: 10.1002/wcms.93)

                         Additional Contributions by
    A. E. DePrince, U. Bozkaya, A. Yu. Sokolov, D. G. A. Smith, R. Di Remigio,
    R. M. Richard, J. F. Gonthier, H. R. McAlexander, M. Saitow, and
    B. P. Pritchard
    -----------------------------------------------------------------------


    Psi4 started on: Tue Jun 28 10:56:58 2016

    Process ID:   7233
    PSI4DATADIR: /theoryfs2/ds/schieber/anaconda2/share/psi4
    Memory level set to 256.000 MB

  ==> Input File <==

--------------------------------------------------------------------------
#Testing the OOP code 
from Epack import Epack #imports a classobj from a module

molecule mol {
    O
    H 1 1.1
    H 1 1.1 2 104

    #C    1.39410    0.00000   0.00000
    #C    0.69705   -1.20732   0.00000
    #C   -0.69705   -1.20732   0.00000
    #C   -1.39410    0.00000   0.00000
    #C   -0.69705    1.20732   0.00000
    #C    0.69705    1.20732   0.00000
    #H    2.47618    0.00000   0.00000
    #H    1.23809   -2.14444   0.00000
    #H   -1.23809   -2.14444   0.00000
    #H   -2.47618    0.00000   0.00000
    #H   -1.23809    2.14444   0.00000
    #H    1.23809    2.14444   0.00000

    symmetry c1
}

set {
    scf_type df
    basis cc-PVDZ
    mp2_type df
}
#Edit molecule and set basis in input.dat, create wavefunction and pass it
# to Epack (classobj) to create instance.  Let the Epack instance do the rest
wfn = psi4.new_wavefunction(mol, psi4.get_global_option('BASIS'))

# Epack(wfn, SCF_dE_tol, SCF_dRMS_tol, iter_tol, SOSCF_dRMS_tol, SOSCF_iter_tol)
Hopefully = Epack(wfn, 1e-11, 1e-10, 100, 8, 5e-3, 25)
Hopefully.energy('MP2')


import time
start = time.time()
print("Psi4 energy: %12.10f" % energy('MP2')) 
print("Psi4 runtime: %6.6f" % (time.time() - start))    
--------------------------------------------------------------------------
    There are an even number of electrons - assuming singlet.
    Specify the multiplicity in the molecule input block.

  ==> DF Tensor (by Rob Parrish) <==

 => Primary Basis Set <= 

  Basis Set: CC-PVDZ
    Number of shells: 12
    Number of basis function: 24
    Number of Cartesian functions: 25
    Spherical Harmonics?: true
    Max angular momentum: 2

 => Auxiliary Basis Set <= 

  Basis Set: 
    Number of shells: 42
    Number of basis function: 116
    Number of Cartesian functions: 131
    Spherical Harmonics?: true
    Max angular momentum: 3


*** tstart() called on ds10
*** at Tue Jun 28 10:56:59 2016


         ---------------------------------------------------------
                                   SCF
            by Justin Turney, Rob Parrish, and Andy Simmonett
                              RHF Reference
                        1 Threads,    256 MiB Core
         ---------------------------------------------------------

  ==> Geometry <==

    Molecular point group: c1
    Full point group: C2v

    Geometry (in Angstrom), charge = 0, multiplicity = 1:

       Center              X                  Y                   Z               Mass       
    ------------   -----------------  -----------------  -----------------  -----------------
           O          0.000000000000     0.000000000000    -0.075791843589    15.994914619560
           H          0.000000000000    -0.866811828967     0.601435779270     1.007825032070
           H          0.000000000000     0.866811828967     0.601435779270     1.007825032070

  Running in c1 symmetry.

  Rotational constants: A =     20.53324  B =     11.13094  C =      7.21807 [cm^-1]
  Rotational constants: A = 615570.97611  B = 333697.07564  C = 216392.23421 [MHz]
  Nuclear repulsion =    8.002366450719082

  Charge       = 0
  Multiplicity = 1
  Electrons    = 10
  Nalpha       = 5
  Nbeta        = 5

  ==> Algorithm <==

  SCF Algorithm Type is DF.
  DIIS enabled.
  MOM disabled.
  Fractional occupation disabled.
  Guess Type is CORE.
  Energy threshold   = 1.00e-08
  Density threshold  = 1.00e-08
  Integral threshold = 0.00e+00

  ==> Primary Basis <==

  Basis Set: CC-PVDZ
    Number of shells: 12
    Number of basis function: 24
    Number of Cartesian functions: 25
    Spherical Harmonics?: true
    Max angular momentum: 2

  ==> Pre-Iterations <==

   -------------------------------------------------------
    Irrep   Nso     Nmo     Nalpha   Nbeta   Ndocc  Nsocc
   -------------------------------------------------------
     A         24      24       0       0       0       0
   -------------------------------------------------------
    Total      24      24       5       5       5       0
   -------------------------------------------------------

  ==> Integral Setup <==

  ==> DFJK: Density-Fitted J/K Matrices <==

    J tasked:                  Yes
    K tasked:                  Yes
    wK tasked:                  No
    OpenMP threads:              1
    Integrals threads:           1
    Memory (MB):               183
    Algorithm:                Core
    Integral Cache:           NONE
    Schwarz Cutoff:          1E-12
    Fitting Condition:       1E-12

   => Auxiliary Basis Set <=

  Basis Set: 
    Number of shells: 42
    Number of basis function: 116
    Number of Cartesian functions: 131
    Spherical Harmonics?: true
    Max angular momentum: 3

  Minimum eigenvalue in the overlap matrix is 4.6103807002E-02.
  Using Symmetric Orthogonalization.
  SCF Guess: Core (One-Electron) Hamiltonian.

  ==> Iterations <==

                           Total Energy        Delta E     RMS |[F,P]|

   @DF-RHF iter   1:   -68.97995836313474   -6.89800e+01   1.16556e-01 
   @DF-RHF iter   2:   -69.64800674043244   -6.68048e-01   1.07424e-01 DIIS
   @DF-RHF iter   3:   -75.79181314575371   -6.14381e+00   2.89357e-02 DIIS
   @DF-RHF iter   4:   -75.97215079350352   -1.80338e-01   7.56827e-03 DIIS
   @DF-RHF iter   5:   -75.98934967725123   -1.71989e-02   8.75461e-04 DIIS
   @DF-RHF iter   6:   -75.98969793187111   -3.48255e-04   5.36092e-04 DIIS
   @DF-RHF iter   7:   -75.98977498932896   -7.70575e-05   6.22295e-05 DIIS
   @DF-RHF iter   8:   -75.98977738525983   -2.39593e-06   2.57952e-05 DIIS
   @DF-RHF iter   9:   -75.98977754261101   -1.57351e-07   1.73338e-06 DIIS
   @DF-RHF iter  10:   -75.98977754512443   -2.51342e-09   7.83896e-07 DIIS
   @DF-RHF iter  11:   -75.98977754538036   -2.55937e-10   1.49551e-07 DIIS
   @DF-RHF iter  12:   -75.98977754538734   -6.97753e-12   1.02570e-08 DIIS
   @DF-RHF iter  13:   -75.98977754538741   -7.10543e-14   7.76635e-10 DIIS

  ==> Post-Iterations <==

    Orbital Energies (a.u.)
    -----------------------

    Doubly Occupied:                                                      

       1A    -20.574753     2A     -1.277569     3A     -0.629914  
       4A     -0.541682     5A     -0.486535  

    Virtual:                                                              

       6A      0.157626     7A      0.229515     8A      0.704725  
       9A      0.744593    10A      1.171018    11A      1.186510  
      12A      1.268187    13A      1.451426    14A      1.474253  
      15A      1.658990    16A      1.804810    17A      1.891669  
      18A      2.149346    19A      2.200781    20A      3.173245  
      21A      3.210313    22A      3.328987    23A      3.721920  
      24A      3.985691  

    Final Occupation by Irrep:
              A 
    DOCC [     5 ]

  Energy converged.

  @DF-RHF Final Energy:   -75.98977754538741

   => Energetics <=

    Nuclear Repulsion Energy =              8.0023664507190819
    One-Electron Energy =                -120.9633819627851494
    Two-Electron Energy =                  36.9712379666786433
    DFT Exchange-Correlation Energy =       0.0000000000000000
    Empirical Dispersion Energy =           0.0000000000000000
    PCM Polarization Energy =               0.0000000000000000
    EFP Energy =                            0.0000000000000000
    Total Energy =                        -75.9897775453874260


  Saving occupied orbitals to File 180.

*** tstop() called on ds10 at Tue Jun 28 10:56:59 2016
Module time:
	user time   =       0.10 seconds =       0.00 minutes
	system time =       0.01 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes
Total time:
	user time   =       0.10 seconds =       0.00 minutes
	system time =       0.01 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes


Properties will be evaluated at   0.000000,   0.000000,   0.000000 Bohr

Properties computed using the SCF density matrix

  Nuclear Dipole Moment: (a.u.)
     X:     0.0000      Y:    -0.0000      Z:     1.1273

  Electronic Dipole Moment: (a.u.)
     X:     0.0000      Y:    -0.0000      Z:    -0.2708

  Dipole Moment: (a.u.)
     X:     0.0000      Y:    -0.0000      Z:     0.8565     Total:     0.8565

  Dipole Moment: (Debye)
     X:     0.0000      Y:    -0.0000      Z:     2.1770     Total:     2.1770


  //>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>//
  //               DFMP2               //
  //<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<//


*** tstart() called on ds10
*** at Tue Jun 28 10:56:59 2016


*** tstop() called on ds10 at Tue Jun 28 10:57:00 2016
Module time:
	user time   =       0.03 seconds =       0.00 minutes
	system time =       0.00 seconds =       0.00 minutes
	total time  =          1 seconds =       0.02 minutes
Total time:
	user time   =       0.13 seconds =       0.00 minutes
	system time =       0.01 seconds =       0.00 minutes
	total time  =          1 seconds =       0.02 minutes
	 --------------------------------------------------------
	                          DF-MP2                         
	      2nd-Order Density-Fitted Moller-Plesset Theory     
	              RMP2 Wavefunction,   1 Threads             
	                                                         
	        Rob Parrish, Justin Turney, Andy Simmonett,      
	           Ed Hohenstein, and C. David Sherrill          
	 --------------------------------------------------------

   => Auxiliary Basis Set <=

  Basis Set: 
    Number of shells: 30
    Number of basis function: 84
    Number of Cartesian functions: 96
    Spherical Harmonics?: true
    Max angular momentum: 3

	 --------------------------------------------------------
	                 NBF =    24, NAUX =    84
	 --------------------------------------------------------
	   CLASS    FOCC     OCC    AOCC    AVIR     VIR    FVIR
	   PAIRS       0       5       5      19      19       0
	 --------------------------------------------------------

	-----------------------------------------------------------
	 ==================> DF-MP2 Energies <==================== 
	-----------------------------------------------------------
	 Reference Energy          =     -75.9897775453874118 [Eh]
	 Singles Energy            =      -0.0000000000000001 [Eh]
	 Same-Spin Energy          =      -0.0531094582360592 [Eh]
	 Opposite-Spin Energy      =      -0.1612006835071581 [Eh]
	 Correlation Energy        =      -0.2143101417432174 [Eh]
	 Total Energy              =     -76.2040876871306239 [Eh]
	-----------------------------------------------------------
	 ================> DF-SCS-MP2 Energies <================== 
	-----------------------------------------------------------
	 SCS Same-Spin Scale       =       0.3333333333333333 [-]
	 SCS Opposite-Spin Scale   =       1.2000000000000000 [-]
	 SCS Same-Spin Energy      =      -0.0177031527453531 [Eh]
	 SCS Opposite-Spin Energy  =      -0.1934408202085897 [Eh]
	 SCS Correlation Energy    =      -0.2111439729539429 [Eh]
	 SCS Total Energy          =     -76.2009215183413602 [Eh]
	-----------------------------------------------------------


*** Psi4 exiting successfully. Buy a developer a beer!
